
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests">
  <title>Baby Bot</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" integrity="sha512-Fo3rlrZj/k7ujlZH0iIqS3FjKzR1eF3U1zT/gY0+Fq/JjKzLzM2vLzNnN7h0K9y" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <style>
    body {
      margin: 0;
      font-family: 'Segoe UI', Arial, sans-serif;
      background: #e0f2f7;
      display: flex;
      flex-direction: column;
      height: 100vh;
      overflow: hidden;
    }

    header {
      background: #007bff;
      color: white;
      padding: 15px;
      text-align: center;
      font-size: 22px;
      font-weight: bold;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      position: relative;
    }

    .call-icons {
      position: absolute;
      right: 15px;
      top: 50%;
      transform: translateY(-50%);
    }
    .call-icons i {
      color: white;
      font-size: 20px;
      margin-left: 15px;
      cursor: pointer;
    }
    .call-icons i:hover {
      color: #ccc;
    }

    nav {
      display: flex;
      justify-content: center;
      background: #007bff;
      border-bottom: 1px solid #0056b3;
    }

    nav button {
      flex: 1;
      padding: 12px;
      border: none;
      background: #007bff;
      color: white;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s ease;
    }

    nav button:hover {
      background: #0056b3;
    }

    nav button.active {
      background: #0056b3;
      border-bottom: 3px solid white;
    }

    section {
      flex: 1;
      display: none;
      padding: 15px;
      overflow-y: auto;
      background: #e0f2f7;
      flex-direction: column;
      justify-content: flex-start;
      position: relative;
      padding-bottom: 40px;
    }
    
    section.active {
      display: flex;
    }
    
    #chat.active {
      display: flex;
    }

    #chat-box {
      flex: 1;
      border: none;
      border-radius: 0;
      padding: 10px;
      background: #e0f2f7;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      scroll-behavior: smooth;
    }

    .message {
      display: flex;
      align-items: flex-end;
      margin: 8px 0;
      max-width: 85%;
    }
    
    .message-content {
      padding: 10px 15px;
      border-radius: 20px;
      position: relative;
      word-wrap: break-word;
      line-height: 1.4;
      font-size: 15px;
    }

    .profile-pic {
      width: 30px;
      height: 30px;
      border-radius: 50%;
      margin: 0 10px;
      object-fit: cover;
      align-self: flex-end;
    }

    .user {
      align-self: flex-end;
      flex-direction: row-reverse;
    }

    .user .message-content {
      background: #007bff;
      color: white;
      border-bottom-right-radius: 5px;
    }

    .bot {
      align-self: flex-start;
      flex-direction: row;
    }

    .bot .message-content {
      background: #f1f0f0;
      color: #333;
      border-bottom-left-radius: 5px;
    }
    
    #chat-input {
      display: flex;
      padding: 10px;
      background: white;
      border-top: 1px solid #ccc;
      box-shadow: 0 -2px 5px rgba(0,0,0,0.05);
      align-items: center;
    }

    #chat-input input {
      flex: 1;
      padding: 12px 15px;
      border: 1px solid #ddd;
      border-radius: 25px;
      font-size: 16px;
      outline: none;
      margin-right: 10px;
      transition: border-color 0.3s ease;
    }

    #chat-input input:focus {
        border-color: #007bff;
    }

    #chat-input button {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      border: none;
      background: #007bff;
      color: white;
      cursor: pointer;
      font-size: 18px;
      display: flex;
      justify-content: center;
      align-items: center;
      transition: background 0.3s ease;
      /* Messenger-like send button style */
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    #chat-input button:hover {
      background: #0056b3;
    }
    
    .teach-box, .info {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        margin-top: 20px;
        line-height: 1.6;
        text-align: center;
    }

    .teach-box h2 {
        color: #007bff;
        margin-top: 0;
    }

    .teach-box input {
      width: calc(100% - 24px);
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #ddd;
      font-size: 16px;
      margin-bottom: 15px;
      box-sizing: border-box;
      transition: border-color 0.3s ease;
    }
    .teach-box input:focus {
        border-color: #007bff;
    }

    .teach-box button {
      width: 100%;
      padding: 12px;
      border-radius: 8px;
      background: #007bff;
      color: white;
      cursor: pointer;
      font-size: 16px;
      transition: background 0.3s ease, transform 0.1s ease;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .teach-box button:hover {
      background: #0056b3;
      transform: translateY(-2px);
    }
    .teach-box button i {
        margin-right: 8px;
    }

    #teachResult {
      margin-top: 15px;
      font-weight: bold;
      color: #007bff;
    }

    .info p strong {
        color: #007bff;
    }
    .info ul {
        list-style-type: none;
        padding: 0;
        margin: 10px 0;
    }
    .info ul li {
        background: #f1f0f0;
        padding: 8px 12px;
        margin-bottom: 5px;
        border-radius: 5px;
    }

    .info ul li code {
        background: #e9e9e9;
        padding: 2px 6px;
        border-radius: 3px;
        font-family: monospace;
    }

    /* Popup Message */
    .popup-message {
      position: fixed;
      bottom: -100px;
      left: 20px;
      background: #4caf50;
      color: white;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.2);
      opacity: 0;
      transition: bottom 0.5s ease-in-out, opacity 0.5s ease-in-out;
      z-index: 1000;
    }
    .popup-message.show {
      bottom: 20px;
      opacity: 1;
    }

    /* Copyright Text */
    .copyright {
      position: absolute;
      bottom: 10px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 12px;
      color: #777;
      text-align: center;
      width: 90%;
    }
  </style>
</head>
<body>
  <header>
    üí¨ Baby Bot üí¨
    <div class="call-icons">
      <i class="fas fa-video"></i>
      <i class="fas fa-phone"></i>
    </div>
  </header>

  <nav>
    <button class="active" data-tab="chat">Baby Chat</button>
    <button data-tab="teach">Baby Teach</button>
    <button data-tab="info">API Info</button>
  </nav>

  <section id="chat" class="active">
    <div id="chat-box"></div>
    <div id="chat-input">
      <input type="text" id="userMessage" placeholder="Type a message...">
      <button id="sendMessageButton" title="Send Message"><i class="fas fa-paper-plane"></i></button>
    </div>
    <p class="copyright">2025 ARIYAN+MIM . All rights reserved</p>
  </section>

  <section id="teach">
    <div class="teach-box">
      <h2>Teach Baby Bot</h2>
      <input type="text" id="teachAsk" placeholder="What should Baby Bot learn?">
      <input type="text" id="teachAns" placeholder="What should Baby Bot reply?">
      <button id="teachBotButton"><i class="fas fa-graduation-cap"></i> Teach Baby</button>
    </div>
    <p id="teachResult"></p>
    <p class="copyright">¬© 2025 Developer ARIYAN  All rights reserved</p>
  </section>

  <section id="info">
    <div class="info">
      <p><strong>Total Hits:</strong> <span id="totalHits">Loading...</span></p>
      <p><strong>Hits (Last 12 Hours):</strong> <span id="last12Hits">Loading...</span></p>
      <p><strong>Total Teaches:</strong> <span id="totalTeaches">Loading...</span></p>
      <p><strong>Current Date & Time:</strong> <span id="currentTime">Loading...</span></p>
      <br>
      <p><strong>API Endpoints:</strong></p>
      <ul>
          <li><strong>Simsimi Endpoint:</strong> <code>/simsimi</code> - ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ <em>(‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: <code>/simsimi?text=Hello</code>)</em></li>
          <li><strong>Teach Endpoint:</strong> <code>/teach</code> - ‡¶¨‡¶ü‡¶ï‡ßá ‡¶∂‡ßá‡¶ñ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ <em>(‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: <code>/teach?ask=How are you&ans=I am fine</code>)</em></li>
          <li><strong>Stats Endpoint:</strong> <code>/stats</code> - ‡¶™‡¶∞‡¶ø‡¶∏‡¶Ç‡¶ñ‡ßç‡¶Ø‡¶æ‡¶® ‡¶¶‡ßá‡¶ñ‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø‡•§ <em>(‡¶â‡¶¶‡¶æ‡¶π‡¶∞‡¶£: <code>/stats</code>)</em></li>
      </ul>
    </div>
    <p class="copyright">¬© 2025 CYBER ARIYAN+MIM </p>
  </section>
  
  <div id="popup" class="popup-message">Teach successfully!</div>

  <script>
    const API_BASE = "";

    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll("nav button").forEach(button => {
            button.addEventListener("click", (event) => {
                showTab(event.target.dataset.tab);
            });
        });

        const userMessageInput = document.getElementById("userMessage");
        const sendMessageButton = document.getElementById("sendMessageButton");

        sendMessageButton.addEventListener("click", sendMessage);
        userMessageInput.addEventListener("keypress", (event) => {
            if (event.key === "Enter") {
                sendMessage();
            }
        });

        document.getElementById("teachBotButton").addEventListener("click", teachBot);

        updateApiInfo();
        setInterval(updateApiInfo, 5000);
        setInterval(updateCurrentTime, 1000);
    });

    function showTab(tabId) {
        document.querySelectorAll("section").forEach(sec => sec.classList.remove("active"));
        document.getElementById(tabId).classList.add("active");

        document.querySelectorAll("nav button").forEach(btn => btn.classList.remove("active"));
        document.querySelector(`nav button[data-tab="${tabId}"]`).classList.add("active");
    }

    async function sendMessage() {
        const input = document.getElementById("userMessage");
        const message = input.value.trim();
        if (!message) return;

        addMessage(message, "user");
        input.value = "";

        try {
            const res = await fetch(`${API_BASE}/simsimi?text=${encodeURIComponent(message)}`);
            if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
            const data = await res.json();
            addMessage(data.response || "No reply. Bot needs more teaching!", "bot");
        } catch (err) {
            console.error("Error sending message:", err);
            addMessage(`Error connecting to API or invalid response: ${err.message}`, "bot");
        }
    }

    function addMessage(text, sender) {
        const chatBox = document.getElementById("chat-box");
        const msg = document.createElement("div");
        msg.className = `message ${sender}`;

        const content = document.createElement("div");
        content.className = "message-content";
        content.textContent = text;

        if (sender === "user") {
            msg.appendChild(content);
        } else {
            const img = document.createElement("img");
            img.className = "profile-pic";
            img.src = "https://i.imgur.com/NJE6q86.jpeg";
            img.alt = "Baby Bot Profile Picture";
            msg.appendChild(img);
            msg.appendChild(content);
        }

        chatBox.appendChild(msg);
        chatBox.scrollTop = chatBox.scrollHeight;
    }

    async function teachBot() {
        const teachAskInput = document.getElementById("teachAsk");
        const teachAnsInput = document.getElementById("teachAns");

        const ask = teachAskInput.value.trim();
        const ans = teachAnsInput.value.trim();

        if (!ask || !ans) {
            alert("Both fields are required!");
            return;
        }

        try {
            const res = await fetch(`${API_BASE}/teach?ask=${encodeURIComponent(ask)}&ans=${encodeURIComponent(ans)}`);
            if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
            const data = await res.json();
            
            showPopup("Teach successfully!");
            teachAskInput.value = "";
            teachAnsInput.value = "";
        } catch (err) {
            console.error("Error teaching bot:", err);
            showPopup(`Error teaching bot: ${err.message}`, true);
        }
    }

    function showPopup(message, isError = false) {
        const popup = document.getElementById("popup");
        popup.textContent = message;
        popup.style.backgroundColor = isError ? "#dc3545" : "#4caf50";
        popup.classList.add("show");
        setTimeout(() => {
            popup.classList.remove("show");
        }, 3000);
    }

    function updateCurrentTime() {
        const currentTimeElement = document.getElementById("currentTime");
        currentTimeElement.innerText = new Date().toLocaleString();
    }

    async function updateApiInfo() {
      try {
        const res = await fetch(`${API_BASE}/stats`);
        if (!res.ok) throw new Error(`HTTP error! Status: ${res.status}`);
        const data = await res.json();

        const totalHits = data.total_hits !== undefined ? data.total_hits : "N/A";
        const last12HoursHits = data.last_12_hours !== undefined ? data.last_12_hours : "N/A";
        const totalTeaches = data.total_teaches !== undefined ? data.total_teaches : "N/A";

        document.getElementById("totalHits").innerText = totalHits;
        document.getElementById("last12Hits").innerText = last12HoursHits;
        document.getElementById("totalTeaches").innerText = totalTeaches;
        
      } catch (err) {
        console.error("Error updating API info:", err);
        document.getElementById("totalHits").innerText = "Error";
        document.getElementById("last12Hits").innerText = "Error";
        document.getElementById("totalTeaches").innerText = "Error";
      }
    }
  </script>
</body>
</html>
